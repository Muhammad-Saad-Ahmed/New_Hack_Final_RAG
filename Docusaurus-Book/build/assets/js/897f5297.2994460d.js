"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[580],{3950(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"ros2-programming/pub-sub","title":"Lesson 2.2: Publishing and Subscribing to Topics","description":"Learn how to use topics to send and receive data between nodes.","source":"@site/docs/02-ros2-programming/02-pub-sub.mdx","sourceDirName":"02-ros2-programming","slug":"/ros2-programming/pub-sub","permalink":"/docs/ros2-programming/pub-sub","draft":false,"unlisted":false,"editUrl":"https://github.com/Muhammad-Saad-Ahmed/New_Hack_Final_RAG/tree/main/docs/02-ros2-programming/02-pub-sub.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Lesson 2.2: Publishing and Subscribing to Topics","description":"Learn how to use topics to send and receive data between nodes."},"sidebar":"tutorialSidebar","previous":{"title":"Lesson 2.1: Writing ROS 2 Nodes with rclpy","permalink":"/docs/ros2-programming/writing-nodes"},"next":{"title":"Lesson 2.3: Services and Actions","permalink":"/docs/ros2-programming/services-actions"}}');var r=s(4848),t=s(8453),o=s(7293);const l={title:"Lesson 2.2: Publishing and Subscribing to Topics",description:"Learn how to use topics to send and receive data between nodes."},c="Lesson 2.2: Publishing and Subscribing to Topics",a={},d=[{value:"Learning Goals",id:"learning-goals",level:2},{value:"The Publisher/Subscriber Model",id:"the-publishersubscriber-model",level:2},{value:"Publisher Node Example",id:"publisher-node-example",level:2},{value:"Code Breakdown",id:"code-breakdown",level:3},{value:"Subscriber Node Example",id:"subscriber-node-example",level:2},{value:"Code Breakdown",id:"code-breakdown-1",level:3},{value:"Hands-on Lab: Connect Your Nodes",id:"hands-on-lab-connect-your-nodes",level:2},{value:"1. Create a Package (or use the previous one)",id:"1-create-a-package-or-use-the-previous-one",level:3},{value:"2. Create the Node Files",id:"2-create-the-node-files",level:3},{value:"3. Update <code>setup.py</code>",id:"3-update-setuppy",level:3},{value:"4. Build and Run",id:"4-build-and-run",level:3}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"lesson-22-publishing-and-subscribing-to-topics",children:"Lesson 2.2: Publishing and Subscribing to Topics"})}),"\n",(0,r.jsx)(n.h2,{id:"learning-goals",children:"Learning Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Understand the publisher/subscriber communication model in ROS 2."}),"\n",(0,r.jsx)(n.li,{children:"Write a Python node that publishes messages to a topic."}),"\n",(0,r.jsx)(n.li,{children:"Write a Python node that subscribes to a topic and processes messages."}),"\n",(0,r.jsx)(n.li,{children:"Run a publisher and subscriber to see them communicate."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"the-publishersubscriber-model",children:"The Publisher/Subscriber Model"}),"\n",(0,r.jsxs)(n.p,{children:["The most common way for nodes to communicate in ROS 2 is through ",(0,r.jsx)(n.strong,{children:"topics"})," using the ",(0,r.jsx)(n.strong,{children:"publisher/subscriber"})," model. This model is asynchronous and decouples the nodes from each other."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.strong,{children:"publisher"})," is a node that sends out data on a specific topic. It doesn't know (or care) if any other nodes are receiving the data."]}),"\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.strong,{children:"subscriber"}),' is a node that receives data by "listening" to a specific topic. It doesn\'t know where the data is coming from.']}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"topic"})," is the named bus that carries the messages from the publisher to the subscriber."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This model allows you to build very flexible and scalable systems. You can add or remove nodes without affecting the other nodes in the system, as long as they are publishing or subscribing to the correct topics."}),"\n",(0,r.jsx)(o.A,{type:"info",title:"Message Types",children:(0,r.jsxs)(n.p,{children:["Every topic has a specific ",(0,r.jsx)(n.strong,{children:"message type"}),". This is a defined data structure that all messages on that topic must follow. For example, a topic for carrying text messages might use the ",(0,r.jsx)(n.code,{children:"String"})," message type from the ",(0,r.jsx)(n.code,{children:"std_msgs"})," package."]})}),"\n",(0,r.jsx)(n.h2,{id:"publisher-node-example",children:"Publisher Node Example"}),"\n",(0,r.jsx)(n.p,{children:'Here is an example of a simple publisher node that publishes a "Hello World" message with a counter every half second.'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# publisher_node.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'chatter', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher_.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"code-breakdown",children:"Code Breakdown"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.create_publisher(String, 'chatter', 10)"}),": Creates a publisher.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The first argument is the message type (",(0,r.jsx)(n.code,{children:"String"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["The second is the topic name (",(0,r.jsx)(n.code,{children:"chatter"}),")."]}),"\n",(0,r.jsx)(n.li,{children:"The third is the queue size. This is a required QoS (Quality of Service) setting."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.create_timer(...)"}),": We use a timer to call the ",(0,r.jsx)(n.code,{children:"timer_callback"})," function periodically."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.publisher_.publish(msg)"}),": This is where the message is actually sent out on the topic."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"subscriber-node-example",children:"Subscriber Node Example"}),"\n",(0,r.jsx)(n.p,{children:"Now, let's create a subscriber node to receive the messages."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# subscriber_node.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'chatter',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"code-breakdown-1",children:"Code Breakdown"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.create_subscription(...)"}),": Creates a subscriber.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The first argument is the message type (",(0,r.jsx)(n.code,{children:"String"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["The second is the topic name (",(0,r.jsx)(n.code,{children:"chatter"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["The third is the callback function (",(0,r.jsx)(n.code,{children:"self.listener_callback"}),") that will be executed every time a message is received."]}),"\n",(0,r.jsx)(n.li,{children:"The fourth is the queue size."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"def listener_callback(self, msg)"}),": This function is called with the received message (",(0,r.jsx)(n.code,{children:"msg"}),") as an argument."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-lab-connect-your-nodes",children:"Hands-on Lab: Connect Your Nodes"}),"\n",(0,r.jsx)(n.h3,{id:"1-create-a-package-or-use-the-previous-one",children:"1. Create a Package (or use the previous one)"}),"\n",(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"my_python_pkg"})," from the previous lesson or create a new one."]}),"\n",(0,r.jsx)(n.h3,{id:"2-create-the-node-files",children:"2. Create the Node Files"}),"\n",(0,r.jsxs)(n.p,{children:["Inside your package's directory (",(0,r.jsx)(n.code,{children:"my_python_pkg/my_python_pkg"}),"), create two new files: ",(0,r.jsx)(n.code,{children:"publisher_node.py"})," and ",(0,r.jsx)(n.code,{children:"subscriber_node.py"}),". Paste the code from the examples above into the corresponding files."]}),"\n",(0,r.jsxs)(n.h3,{id:"3-update-setuppy",children:["3. Update ",(0,r.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,r.jsxs)(n.p,{children:["Add entry points for both nodes in your ",(0,r.jsx)(n.code,{children:"setup.py"})," file."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Inside setup.py\nentry_points={\n    'console_scripts': [\n        'hello_ros2 = my_python_pkg.hello_node:main',\n        'talker = my_python_pkg.publisher_node:main',\n        'listener = my_python_pkg.subscriber_node:main',\n    ],\n},\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-build-and-run",children:"4. Build and Run"}),"\n",(0,r.jsx)(n.p,{children:"Now, build your package and run the nodes."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# In your workspace root (e.g., ~/ros2_ws)\ncolcon build --packages-select my_python_pkg\nsource install/setup.bash\n\n# In one terminal, run the publisher\nros2 run my_python_pkg talker\n\n# In a NEW terminal, run the subscriber\nros2 run my_python_pkg listener\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You should see the ",(0,r.jsx)(n.code,{children:"talker"})," terminal publishing messages and the ",(0,r.jsx)(n.code,{children:"listener"}),' terminal printing "I heard: ..." for each message. You have successfully established communication between two nodes using a topic!']})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},7293(e,n,s){s.d(n,{A:()=>z});var i=s(6540),r=s(4848);function t(e){const{mdxAdmonitionTitle:n,rest:s}=function(e){const n=i.Children.toArray(e),s=n.find(e=>i.isValidElement(e)&&"mdxAdmonitionTitle"===e.type),t=n.filter(e=>e!==s),o=s?.props.children;return{mdxAdmonitionTitle:o,rest:t.length>0?(0,r.jsx)(r.Fragment,{children:t}):null}}(e.children),t=e.title??n;return{...e,...t&&{title:t},children:s}}var o=s(4164),l=s(1312),c=s(7559);const a="admonition_xJq3",d="admonitionHeading_Gvgb",h="admonitionIcon_Rf37",u="admonitionContent_BuS1";function p({type:e,className:n,children:s}){return(0,r.jsx)("div",{className:(0,o.A)(c.G.common.admonition,c.G.common.admonitionType(e),a,n),children:s})}function m({icon:e,title:n}){return(0,r.jsxs)("div",{className:d,children:[(0,r.jsx)("span",{className:h,children:e}),n]})}function b({children:e}){return e?(0,r.jsx)("div",{className:u,children:e}):null}function g(e){const{type:n,icon:s,title:i,children:t,className:o}=e;return(0,r.jsxs)(p,{type:n,className:o,children:[i||s?(0,r.jsx)(m,{title:i,icon:s}):null,(0,r.jsx)(b,{children:t})]})}function x(e){return(0,r.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const f={icon:(0,r.jsx)(x,{}),title:(0,r.jsx)(l.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function j(e){return(0,r.jsx)(g,{...f,...e,className:(0,o.A)("alert alert--secondary",e.className),children:e.children})}function _(e){return(0,r.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const y={icon:(0,r.jsx)(_,{}),title:(0,r.jsx)(l.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function v(e){return(0,r.jsx)(g,{...y,...e,className:(0,o.A)("alert alert--success",e.className),children:e.children})}function w(e){return(0,r.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const k={icon:(0,r.jsx)(w,{}),title:(0,r.jsx)(l.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function N(e){return(0,r.jsx)(g,{...k,...e,className:(0,o.A)("alert alert--info",e.className),children:e.children})}function T(e){return(0,r.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const S={icon:(0,r.jsx)(T,{}),title:(0,r.jsx)(l.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function A(e){return(0,r.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const C={icon:(0,r.jsx)(A,{}),title:(0,r.jsx)(l.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const M={icon:(0,r.jsx)(T,{}),title:(0,r.jsx)(l.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const P={...{note:j,tip:v,info:N,warning:function(e){return(0,r.jsx)(g,{...S,...e,className:(0,o.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,r.jsx)(g,{...C,...e,className:(0,o.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,r.jsx)(j,{title:"secondary",...e}),important:e=>(0,r.jsx)(N,{title:"important",...e}),success:e=>(0,r.jsx)(v,{title:"success",...e}),caution:function(e){return(0,r.jsx)(g,{...M,...e,className:(0,o.A)("alert alert--warning",e.className),children:e.children})}}};function z(e){const n=t(e),s=(i=n.type,P[i]||(console.warn(`No admonition component found for admonition type "${i}". Using Info as fallback.`),P.info));var i;return(0,r.jsx)(s,{...n})}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);